import{a as w}from"./chunk-L2CXA6PW.js";import{a as T,b as I}from"./chunk-UXBQWYA2.js";import{i as b,r as v,s as C,t as y,u as _,v as S}from"./chunk-NI7OY2TA.js";import{f as E}from"./chunk-SPIBSKG6.js";import{a as P}from"./chunk-X3KPJDVG.js";import{C as f,Ec as x,Fa as c,Fb as d,Ka as o,Ra as g,gc as u,ib as m,jb as n,kb as s,lb as h,qb as l}from"./chunk-S46BXV3G.js";var D=class p{constructor(e,a,t,i,r,k){this.examService=e;this.cdr=a;this.dialog=t;this.confirm=i;this.toast=r;this.router=k}columns=[{label:"ID",field:"id",sortable:!0},{label:"Exam Title",field:"title",sortable:!0},{label:"Description",field:"description"},{label:"Start Time",field:"startTime",pipe:"date",sortable:!0},{label:"End Time",field:"endTime",pipe:"date",sortable:!0},{label:"Status",field:"isActive",pipe:"boolean",sortable:!0}];actions=[{icon:"fas fa-edit",tooltip:"Edit",type:"edit",color:"#007bff"},{icon:"fas fa-trash",tooltip:"Delete",type:"delete",color:"#dc3545"},{icon:"fas fa-eye",tooltip:"View",type:"view",color:"#28a745"}];exams=[];loading=!1;searchTerm=new b("");paginationInfo={currentPage:1,totalPages:1,totalItems:0,itemsPerPage:5};currentSort=null;ngOnInit(){this.fetchExams(),this.searchTerm.valueChanges.pipe(f(400)).subscribe(()=>{this.paginationInfo.currentPage=1,this.fetchExams()})}fetchExams(){this.loading=!0,this.cdr.markForCheck();let e=this.searchTerm.value||"",a=this.currentSort?.field||"id",t=this.currentSort?.direction==="desc";this.examService.getAllExams(e,a,t,this.paginationInfo.currentPage,this.paginationInfo.itemsPerPage).subscribe({next:i=>{this.exams=i.items,this.paginationInfo.totalItems=i.totalItems,this.paginationInfo.totalPages=i.totalPages,this.paginationInfo.currentPage=i.currentPage,this.loading=!1,this.cdr.markForCheck()},error:i=>{console.error("\u274C Error fetching exams:",i),this.exams=[],this.loading=!1,this.cdr.markForCheck()}})}openDialog(e="add",a){this.dialog.open(I,{data:{title:e==="edit"?"Edit Exam":"Add Exam",action:e,exam:a,formType:"exam"},width:"500px"}).afterClosed().subscribe(i=>{i&&(e==="edit"?this.updateExam(i):this.addExam(i))})}onActionClick(e){switch(e.type){case"edit":this.editExam(e.row);break;case"delete":this.deleteExam(e.row);break;case"view":this.viewExam(e.row);break}}onPageChange(e){this.paginationInfo.currentPage=e,this.fetchExams()}onSortChange(e){this.currentSort=e,this.fetchExams()}addExam(e){let a={title:e.title,description:e.description,startTime:e.startTime,endTime:e.endTime,createdBy:1};this.examService.addExam(a).subscribe({next:()=>{this.toast.show("Exam added successfully","success"),this.fetchExams()},error:()=>this.toast.show("Failed to add exam","error")})}editExam(e){this.openDialog("edit",e)}updateExam(e){let a={title:e.title,description:e.description,startTime:e.startTime,endTime:e.endTime,createdBy:1};this.examService.updateExam(e.id,a).subscribe({next:()=>{this.toast.show("Exam updated successfully","success"),this.fetchExams()},error:()=>this.toast.show("Failed to update exam","error")})}deleteExam(e){this.confirm.show("Delete Confirmation",`Are you sure you want to delete the exam "${e.title}"?`,()=>{this.examService.deleteExam(e.id).subscribe({next:()=>{this.toast.show("Exam deleted successfully","success"),this.fetchExams()},error:()=>this.toast.show("Failed to delete exam","error")})},{isSuccess:!1,okText:"Delete"})}viewExam(e){e?.id&&this.router.navigateByUrl(`/dashboard/exams/${e.id}`)}static \u0275fac=function(a){return new(a||p)(o(w),o(u),o(T),o(_),o(S),o(E))};static \u0275cmp=g({type:p,selectors:[["app-all-exams"]],decls:10,vars:12,consts:[[1,"page-container"],[1,"page-header"],[1,"title"],[1,"description"],[1,"flex","justify-between","items-center","w-100"],["placeholder","Search...","icon","fa-solid fa-magnifying-glass","type","text",1,"search-input",3,"control"],["text","Add Exam","icon","fa-solid fa-plus","type","button",1,"add-button",3,"click","loading"],[3,"actionClick","pageChange","sortChange","columns","data","actions","loading","striped","hoverable","caption","paginationInfo","useBackendPagination","currentSort"]],template:function(a,t){a&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),d(3,"\u{1F4DA} Exams Management"),s(),n(4,"p",3),d(5," Here you can view, search, add, edit, or delete exams in the system. "),s()(),n(6,"div",4),h(7,"app-custom-input",5),n(8,"app-button",6),l("click",function(){return t.openDialog()}),s()(),n(9,"app-table",7),l("actionClick",function(r){return t.onActionClick(r)})("pageChange",function(r){return t.onPageChange(r)})("sortChange",function(r){return t.onSortChange(r)}),s()()),a&2&&(c(7),m("control",t.searchTerm),c(),m("loading",t.loading),c(),m("columns",t.columns)("data",t.exams)("actions",t.actions)("loading",t.loading)("striped",!0)("hoverable",!0)("caption","Exams")("paginationInfo",t.paginationInfo)("useBackendPagination",!0)("currentSort",t.currentSort))},dependencies:[x,P,C,y,v],styles:[".flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:16px}.search-input[_ngcontent-%COMP%]{width:50%}.add-button[_ngcontent-%COMP%]{margin-bottom:16px}.search-input[_ngcontent-%COMP%]     .mat-mdc-form-field{width:100%!important}.page-container[_ngcontent-%COMP%]{max-width:1200px;padding:1rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem;text-align:center}.page-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin-bottom:.5rem}.page-header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:1rem;color:#797979}.actions-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;flex-wrap:wrap;gap:1rem}"],changeDetection:0})};export{D as AllExams};
